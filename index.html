<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ãrbol GenealÃ³gico Familiar</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <!-- LOGIN SCREEN -->
  <div id="loginScreen" class="login-screen">
    <div class="login-container">
      <div class="login-icon">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</div>
      <h1>Ãrbol GenealÃ³gico</h1>
      <p class="subtitle">Acceso Familiar Protegido</p>
      
      <div id="loginError" class="error-message"></div>
      
      <form id="loginForm">
        <input type="password" id="passwordInput" placeholder="Ingresa la contraseÃ±a" required>
        <button type="submit" class="btn-login">ğŸ” Acceder</button>
      </form>
      
      <div class="info-box">
        ğŸ”’ Ãrea protegida por contraseÃ±a
      </div>
    </div>
  </div>

  <!-- MAIN APP -->
  <div id="mainApp" class="hidden">
    <!-- Header -->
    <header class="header">
      <div class="header-content">
        <h1>ğŸŒ³ Ãrbol GenealÃ³gico Familiar</h1>
        <div class="header-actions">
          <span id="userBadge" class="badge"></span>
          <button id="adminPanelBtn" class="btn-secondary hidden">âš™ï¸ Panel Admin</button>
          <button id="viewTreeBtn" class="btn-secondary hidden">ğŸŒ³ Ver Ãrbol</button>
          <button id="logoutBtn" class="btn-danger">Cerrar SesiÃ³n</button>
        </div>
      </div>
    </header>

    <!-- Tree View -->
    <div id="treeView" class="container">
      <div class="controls">
        <button id="zoomIn" class="btn-control">ğŸ” +</button>
        <button id="zoomOut" class="btn-control">ğŸ” -</button>
        <button id="resetZoom" class="btn-control">â†º Reset</button>
        <button id="expandAll" class="btn-control">ğŸ“‚ Expandir</button>
        <button id="collapseAll" class="btn-control">ğŸ“ Colapsar</button>
        <input type="file" id="fileUpload" accept=".json" style="display: none;" onchange="handleFileUpload(event)">
        <button class="btn-control" onclick="document.getElementById('fileUpload').click()">ğŸ“ Importar JSON</button>
      </div>
      <div id="treeContainer" class="tree-canvas"></div>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel" class="container hidden">
      <div class="admin-grid">
        <!-- Personas -->
        <div class="panel">
          <h2>ğŸ‘¤ GestiÃ³n de Personas</h2>
          <form id="personForm" class="form">
            <input type="hidden" id="personId">
            <div class="form-row">
              <div class="form-group">
                <label>Nombre *</label>
                <input type="text" id="nombre" required>
              </div>
              <div class="form-group">
                <label>Apellidos *</label>
                <input type="text" id="apellidos" required>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label>GÃ©nero *</label>
                <select id="genero" required>
                  <option value="">Seleccionar</option>
                  <option value="Masculino">Masculino</option>
                  <option value="Femenino">Femenino</option>
                </select>
              </div>
              <div class="form-group">
                <label>Fecha Nacimiento</label>
                <input type="date" id="fechaNacimiento">
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label>Lugar Nacimiento</label>
                <input type="text" id="lugarNacimiento">
              </div>
              <div class="form-group">
                <label>Fecha Muerte</label>
                <input type="date" id="fechaMuerte">
              </div>
            </div>
            <div class="form-group">
              <label>URL Foto (opcional)</label>
              <input type="url" id="photoUrl" placeholder="https://...">
            </div>
            <div class="form-group">
              <label>Notas</label>
              <textarea id="notas" rows="2"></textarea>
            </div>
            <div class="form-actions">
              <button type="submit" class="btn-primary">Guardar</button>
              <button type="button" id="clearPersonForm" class="btn-secondary">Limpiar</button>
            </div>
          </form>
          <div id="personsList" class="items-list"></div>
        </div>

        <!-- Relaciones -->
        <div class="panel">
          <h2>ğŸ”— GestiÃ³n de Relaciones</h2>
          <form id="relationForm" class="form">
            <div class="form-group">
              <label>Persona 1 *</label>
              <select id="person1" required></select>
            </div>
            <div class="form-group">
              <label>Persona 2 *</label>
              <select id="person2" required></select>
            </div>
            <div class="form-group">
              <label>Tipo de RelaciÃ³n *</label>
              <select id="relationType" required>
                <option value="">Seleccionar</option>
                <option value="esposa">ğŸ’‘ Matrimonio</option>
                <option value="hijo">ğŸ‘¶ Padre/Hijo</option>
              </select>
            </div>
            <div class="form-actions">
              <button type="submit" class="btn-primary">Crear RelaciÃ³n</button>
            </div>
          </form>
          <div id="relationsList" class="items-list"></div>
        </div>
      </div>
    </div>
  </div>

  <script src="js/data.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/tree.js"></script>
</body>
</html>
